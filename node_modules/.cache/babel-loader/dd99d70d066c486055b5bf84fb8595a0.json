{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nexports.__esModule = true;\nexports.executeQuery = void 0;\n\nvar debug_1 = require(\"debug\");\n\nvar glossary_1 = require(\"../glossary\");\n\nvar compileQuery_1 = require(\"./compileQuery\");\n\nvar iteratorUtils = __importStar(require(\"../utils/iteratorUtils\"));\n\nvar paginateResults_1 = require(\"./paginateResults\");\n\nvar sortResults_1 = require(\"./sortResults\");\n\nvar outvariant_1 = require(\"outvariant\");\n\nvar log = debug_1.debug('executeQuery');\n\nfunction queryByPrimaryKey(records, query) {\n  log('querying by primary key');\n  log('query by primary key', {\n    query: query,\n    records: records\n  });\n  var matchPrimaryKey = compileQuery_1.compileQuery(query);\n  var result = iteratorUtils.filter(function (id, value) {\n    var _a;\n\n    var primaryKey = value[glossary_1.PRIMARY_KEY];\n    outvariant_1.invariant(primaryKey, 'Failed to query by primary key using \"%j\": record (%j) has no primary key set.', query, value);\n    return matchPrimaryKey((_a = {}, _a[primaryKey] = id, _a));\n  }, records);\n  log('result of querying by primary key:', result);\n  return result;\n}\n/**\n * Execute a given query against a model in the database.\n * Returns the list of records that satisfy the query.\n */\n\n\nfunction executeQuery(modelName, primaryKey, query, db) {\n  var _a;\n\n  log(JSON.stringify(query) + \" on \\\"\" + modelName + \"\\\"\");\n  log('using primary key \"%s\"', primaryKey);\n  var records = db.getModel(modelName); // Reduce the query scope if there's a query by primary key of the model.\n\n  var _b = query.where || {},\n      _c = primaryKey,\n      primaryKeyComparator = _b[_c],\n      restQueries = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n\n  log('primary key query', primaryKeyComparator);\n  var scopedRecords = primaryKeyComparator ? queryByPrimaryKey(records, {\n    where: (_a = {}, _a[primaryKey] = primaryKeyComparator, _a)\n  }) : records;\n  var result = iteratorUtils.filter(function (_, record) {\n    var executeQuery = compileQuery_1.compileQuery({\n      where: restQueries\n    });\n    return executeQuery(record);\n  }, scopedRecords);\n  var resultJson = Array.from(result.values());\n  log(\"resolved query \\\"\" + JSON.stringify(query) + \"\\\" on \\\"\" + modelName + \"\\\" to\", resultJson);\n\n  if (query.orderBy) {\n    sortResults_1.sortResults(query.orderBy, resultJson);\n  }\n\n  var paginatedResults = paginateResults_1.paginateResults(query, resultJson);\n  log('paginated query results', paginatedResults);\n  return paginatedResults;\n}\n\nexports.executeQuery = executeQuery;","map":{"version":3,"names":["__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","prototype","hasOwnProperty","call","__rest","s","e","t","p","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","exports","executeQuery","debug_1","require","glossary_1","compileQuery_1","iteratorUtils","paginateResults_1","sortResults_1","outvariant_1","log","debug","queryByPrimaryKey","records","query","matchPrimaryKey","compileQuery","filter","id","_a","primaryKey","PRIMARY_KEY","invariant","modelName","db","JSON","stringify","getModel","_b","where","_c","primaryKeyComparator","restQueries","scopedRecords","_","record","resultJson","Array","from","values","orderBy","sortResults","paginatedResults","paginateResults"],"sources":["/Users/mcakmakali/Desktop/redux-example/node_modules/@mswjs/data/lib/query/executeQuery.js"],"sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nexports.__esModule = true;\nexports.executeQuery = void 0;\nvar debug_1 = require(\"debug\");\nvar glossary_1 = require(\"../glossary\");\nvar compileQuery_1 = require(\"./compileQuery\");\nvar iteratorUtils = __importStar(require(\"../utils/iteratorUtils\"));\nvar paginateResults_1 = require(\"./paginateResults\");\nvar sortResults_1 = require(\"./sortResults\");\nvar outvariant_1 = require(\"outvariant\");\nvar log = debug_1.debug('executeQuery');\nfunction queryByPrimaryKey(records, query) {\n    log('querying by primary key');\n    log('query by primary key', { query: query, records: records });\n    var matchPrimaryKey = compileQuery_1.compileQuery(query);\n    var result = iteratorUtils.filter(function (id, value) {\n        var _a;\n        var primaryKey = value[glossary_1.PRIMARY_KEY];\n        outvariant_1.invariant(primaryKey, 'Failed to query by primary key using \"%j\": record (%j) has no primary key set.', query, value);\n        return matchPrimaryKey((_a = {}, _a[primaryKey] = id, _a));\n    }, records);\n    log('result of querying by primary key:', result);\n    return result;\n}\n/**\n * Execute a given query against a model in the database.\n * Returns the list of records that satisfy the query.\n */\nfunction executeQuery(modelName, primaryKey, query, db) {\n    var _a;\n    log(JSON.stringify(query) + \" on \\\"\" + modelName + \"\\\"\");\n    log('using primary key \"%s\"', primaryKey);\n    var records = db.getModel(modelName);\n    // Reduce the query scope if there's a query by primary key of the model.\n    var _b = query.where || {}, _c = primaryKey, primaryKeyComparator = _b[_c], restQueries = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n    log('primary key query', primaryKeyComparator);\n    var scopedRecords = primaryKeyComparator\n        ? queryByPrimaryKey(records, {\n            where: (_a = {}, _a[primaryKey] = primaryKeyComparator, _a)\n        })\n        : records;\n    var result = iteratorUtils.filter(function (_, record) {\n        var executeQuery = compileQuery_1.compileQuery({ where: restQueries });\n        return executeQuery(record);\n    }, scopedRecords);\n    var resultJson = Array.from(result.values());\n    log(\"resolved query \\\"\" + JSON.stringify(query) + \"\\\" on \\\"\" + modelName + \"\\\" to\", resultJson);\n    if (query.orderBy) {\n        sortResults_1.sortResults(query.orderBy, resultJson);\n    }\n    var paginatedResults = paginateResults_1.paginateResults(query, resultJson);\n    log('paginated query results', paginatedResults);\n    return paginatedResults;\n}\nexports.executeQuery = executeQuery;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}