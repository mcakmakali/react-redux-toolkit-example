{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createInterceptor = void 0;\n\nvar strict_event_emitter_1 = require(\"strict-event-emitter\");\n\nfunction createInterceptor(options) {\n  var observer = new strict_event_emitter_1.StrictEventEmitter();\n  var cleanupFns = [];\n  return {\n    apply: function () {\n      cleanupFns = options.modules.map(function (interceptor) {\n        return interceptor(observer, options.resolver);\n      });\n    },\n    on: function (event, listener) {\n      observer.addListener(event, listener);\n    },\n    restore: function () {\n      observer.removeAllListeners();\n\n      if (cleanupFns.length === 0) {\n        throw new Error(\"Failed to restore patched modules: no patches found. Did you forget to run \\\".apply()\\\"?\");\n      }\n\n      cleanupFns.forEach(function (restore) {\n        return restore();\n      });\n    }\n  };\n}\n\nexports.createInterceptor = createInterceptor;","map":{"version":3,"mappings":";;;;;;;AAEA;;AAgEA,SAAgBA,iBAAhB,CAAkCC,OAAlC,EAA6D;EAC3D,IAAMC,QAAQ,GAAG,IAAIC,yCAAJ,EAAjB;EACA,IAAIC,UAAU,GAA2B,EAAzC;EAEA,OAAO;IACLC,KAAK;MACHD,UAAU,GAAGH,OAAO,CAACK,OAAR,CAAgBC,GAAhB,CAAoB,UAACC,WAAD,EAAY;QAC3C,OAAOA,WAAW,CAACN,QAAD,EAAWD,OAAO,CAACQ,QAAnB,CAAlB;MACD,CAFY,CAAb;IAGD,CALI;IAMLC,EAAE,YAACC,KAAD,EAAQC,QAAR,EAAgB;MAChBV,QAAQ,CAACW,WAAT,CAAqBF,KAArB,EAA4BC,QAA5B;IACD,CARI;IASLE,OAAO;MACLZ,QAAQ,CAACa,kBAAT;;MAEA,IAAIX,UAAU,CAACY,MAAX,KAAsB,CAA1B,EAA6B;QAC3B,MAAM,IAAIC,KAAJ,CACJ,0FADI,CAAN;MAGD;;MAEDb,UAAU,CAACc,OAAX,CAAmB,UAACJ,OAAD,EAAQ;QAAK,cAAO,EAAP;MAAS,CAAzC;IACD;EAnBI,CAAP;AAqBD;;AAzBDK","names":["createInterceptor","options","observer","strict_event_emitter_1","cleanupFns","apply","modules","map","interceptor","resolver","on","event","listener","addListener","restore","removeAllListeners","length","Error","forEach","exports"],"sourceRoot":"","sources":["../src/createInterceptor.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}